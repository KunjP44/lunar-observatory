<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Lunar Observatory</title>
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <link rel="manifest" href="./frontend/manifest.json">
    <link rel="stylesheet" href="./frontend/styles/ui.css">
    <!-- <link rel="icon" type="image/svg+xml" href="./frontend/assets/logo.svg"> -->
    <link rel="icon" type="image/svg+xml" href="./frontend/assets/logo-web-cir.svg">

    <meta name="theme-color" content="#000000">

</head>

<body>

    <div id="env-gradient"></div>

    <div id="loader">
        <div class="loader-spinner"></div>
        <div class="loader-text">Initializing Observatory</div>
    </div>

    <div class="mode-switch-container">
        <div class="mode-segmented-control">
            <button id="solar-mode-btn" class="mode-btn active">Solar</button>
            <button id="lunar-mode-btn" class="mode-btn">Observatory</button>
            <button id="learning-mode-btn" class="mode-btn">Learn</button>
        </div>
    </div>

    <div class="ui-controls solar-controls">
        <div class="control-bar">
            <button id="reset-view" class="control-btn" title="Reset View">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                    <path d="M3 3v5h5"></path>
                </svg>
                <span class="btn-label" id="reset-label">Reset View</span>
            </button>

            <div class="vertical-divider"></div>

            <button id="btn-date-trigger" class="control-btn" title="Change Date">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <span class="btn-label" id="solar-date-label">Today</span>
            </button>
            <div class="vertical-divider"></div>

            <button id="btn-notifications" class="control-btn" title="Notifications">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M18 8a6 6 0 0 0-12 0c0 7-3 7-3 7h18s-3 0-3-7"></path>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                </svg>
                <span class="btn-label">Alerts</span>
            </button>
        </div>

        <div id="solar-date-picker" class="date-picker-popup hidden">
            <div class="picker-header">Travel to Date</div>
            <input type="date" id="solar-date-input" class="modern-date-input" />
            <div class="picker-actions">
                <button class="date-btn secondary" id="solar-cancel-date">Cancel</button>
                <button class="date-btn primary" id="solar-apply-date">Warp</button>
            </div>
        </div>

        <div id="notification-popup" class="date-picker-popup hidden">
            <div class="picker-header">Notifications</div>

            <button class="date-btn secondary" id="enable-daily-brief">
                üåÖ Daily Morning Brief (7 AM IST)
            </button>

            <button class="date-btn secondary" id="enable-planet-brief">
                ü™ê Daily Planet Visibility
            </button>

            <button class="date-btn secondary" id="disable-notifications">
                ‚ùå Disable All
            </button>
        </div>
    </div>
    <div id="page-transition" class="page-transition hidden"></div>
    <div id="focus-indicator" class="focus-indicator hidden">FOCUSED: <span id="focus-name">Moon</span></div>
    <div id="focus-overlay"></div>

    <div id="info-card" class="info-card hidden collapsed">

        <div class="card-header">
            <h2 id="card-title">Moon</h2>
            <span id="card-type">Satellite</span>

            <!-- CLOSE / COLLAPSE BUTTON -->
            <button class="card-close" id="close-card">‚úï</button>
        </div>

        <div class="info-card-content">
            <p id="card-description-short" class="desc-short"></p>

            <div class="quick-facts">
                <div><span>Distance</span><span id="fact-distance"></span></div>
                <div><span>Radius</span><span id="fact-radius"></span></div>
                <div><span>Gravity</span><span id="fact-gravity"></span></div>
                <div><span>Orbital Period</span><span id="fact-orbit"></span></div>
            </div>

            <button id="toggle-details" class="toggle-btn">VIEW SYSTEM DATA</button>

            <div id="card-details" class="card-details">
                <p id="card-description-long"></p>

                <h4>Composition</h4>
                <ul id="surface-list"></ul>

                <h4>Geology</h4>
                <ul id="features-list"></ul>

                <h4>Data</h4>
                <ul id="fun-facts-list"></ul>
            </div>
        </div>
    </div>


    <div class="ui-top">
        <div class="ui-title">Lunar Observatory-Œ±</div>
        <div class="ui-subtitle">Interactive Astronomy Tool</div>
        <div class="ui-alpha-note">
            This application is currently in alpha version. Features and data may change.
        </div>
    </div>

    <div class="ui-hint">Navigate: Drag ¬∑ Zoom: Scroll ¬∑ Focus: Double Click</div>

    <section id="moon-mode" class="moon-mode hidden">
        <div class="lunar-layout">
            <div class="lunar-visual">
            </div>
            <div id="moon-sheet" class="lunar-cards">

                <section class="moon-card hero-card" id="date-card">
                    <div class="date-display" id="date-display">
                        <div class="date-row">
                            <div class="date-big" id="date-day">24</div>
                            <div class="date-col">
                                <span class="date-month" id="date-month">February 2026</span>
                                <span class="date-weekday" id="date-weekday">Monday</span>
                            </div>
                        </div>
                        <button class="action-chip" id="open-date-picker">
                            <span>Change Date</span>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="3">
                                <path d="M9 18l6-6-6-6" />
                            </svg>
                        </button>
                    </div>

                    <div class="date-picker hidden" id="date-picker">
                        <div class="picker-header">
                            <span>Select Observation Date</span>
                        </div>
                        <input type="date" id="date-input" class="modern-date-input" />
                        <div class="picker-actions">
                            <button class="date-btn secondary" id="cancel-date">Cancel</button>
                            <button class="date-btn primary" id="apply-date">Observe</button>
                        </div>
                    </div>
                </section>

                <div id="moon-content">
                    <section class="moon-card">
                        <div class="card-header-row">
                            <div class="icon-box blue">‚óê</div>
                            <h3>Phase Cycle</h3>
                        </div>
                        <div class="data-list">
                            <div class="data-row">
                                <span class="label">Current Phase</span>
                                <span class="value" id="ui-phase">‚Äî</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Illumination</span>
                                <span class="value highlight" id="ui-illum">‚Äî</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Lunar Age</span>
                                <span class="value" id="ui-age">‚Äî</span>
                            </div>
                        </div>
                    </section>

                    <section class="moon-card">
                        <div class="card-header-row">
                            <div class="icon-box purple">üïâ</div>
                            <h3>Panchang</h3>
                        </div>
                        <div class="data-list">
                            <div class="data-row">
                                <span class="label">Tithi</span>
                                <span class="value" id="ui-tithi">‚Äî</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Paksha</span>
                                <span class="value" id="ui-paksha">‚Äî</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Nakshatra</span>
                                <span class="value" id="ui-nakshatra">‚Äî</span>
                            </div>
                        </div>
                    </section>

                    <section class="moon-card">
                        <div class="card-header-row">
                            <div class="icon-box green">üî≠</div>
                            <h3>Astrophysics</h3>
                        </div>
                        <div class="data-list">
                            <div class="data-row">
                                <span class="label">Distance</span>
                                <span class="value" id="ui-distance">‚Äî</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Velocity</span>
                                <span class="value">1.022 km/s</span>
                            </div>
                        </div>
                    </section>

                    <div id="planet-visibility-section" class="hidden">
                        <section class="moon-card">
                            <div class="card-header-row">
                                <div class="icon-box blue">ü™ê</div>
                                <h3>Planetary Visibility</h3>
                            </div>
                            <div id="planet-visibility-list">
                            </div>
                        </section>
                    </div>
                </div>
                <div class="mobile-spacer"></div>
                <div class="scroll-buffer"></div>
            </div>
        </div>
    </section>

    <section id="learn-mode" class="learn-mode hidden">

        <!-- ================= HOME VIEW ================= -->
        <div id="learn-home">

            <div class="learn-header">
                <h1>Learn Astronomy</h1>
                <p>Interactive visual lessons to understand celestial mechanics.</p>
            </div>

            <div class="learn-grid">

                <!-- SOLAR ECLIPSE -->
                <div class="lesson-card" data-lesson="solar-eclipse">
                    <div class="lesson-canvas eclipse-preview">
                        <div class="sun"></div>
                        <div class="moon"></div>
                    </div>
                    <h3>Solar Eclipse</h3>
                    <p>
                        Understand how the Moon blocks sunlight and creates total,
                        partial and annular eclipses on Earth.
                    </p>
                    <button class="lesson-btn">Explore Lesson</button>
                </div>

                <div class="lesson-card" data-lesson="earth-rotation">
                    <div class="lesson-canvas rotation-preview"></div>
                    <h3>Earth Rotation</h3>
                    <p>
                        See how Earth's rotation causes day and night.
                    </p>
                    <button class="lesson-btn">Explore Lesson</button>
                </div>

                <!-- PLANET ORBITS -->
                <div class="lesson-card" data-lesson="planet-orbits">
                    <div class="lesson-canvas orbit-preview"></div>
                    <h3>Planet Orbits</h3>
                    <p>
                        Understand elliptical motion and orbital periods.
                    </p>
                    <button class="lesson-btn">Explore Lesson</button>
                </div>

                <!-- LUNAR ECLIPSE -->
                <div class="lesson-card" data-lesson="lunar-eclipse">
                    <div class="lesson-canvas lunar-preview">
                        <div class="earth"></div>
                        <div class="moon-eclipse"></div>
                    </div>
                    <h3>Lunar Eclipse</h3>
                    <p>
                        Learn how Earth's shadow falls on the Moon and why
                        it sometimes turns red during totality.
                    </p>
                    <button class="lesson-btn">Explore Lesson</button>
                </div>

            </div>
        </div>


        <!-- ================= DETAIL VIEW ================= -->
        <div id="learn-detail" class="hidden">

            <button id="learn-back-btn" class="control-btn">
                ‚Üê Back to Lessons
            </button>

            <div id="learn-lesson-container"></div>

        </div>

    </section>

    <!-- Observatory Beacon -->
    <div id="event-beacon" class="event-beacon">
        <div class="beacon-dot"></div>
    </div>

    <!-- Intelligence Log Panel -->
    <div id="events-panel" class="events-panel">
        <div class="events-header">
            <span>ASTRONOMY INTELLIGENCE LOG</span>
            <button id="close-events" class="panel-close-btn">‚úï</button>
        </div>

        <div id="events-year-label" class="events-year-label"></div>

        <div id="events-container" class="events-container"></div>
    </div>

    <script type="module" src="./frontend/src/main.js"></script>
    <script>
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("./frontend/sw.js")
                .then((registration) => {
                    console.log("Service Worker registered with scope:", registration.scope);
                })
                .catch((error) => {
                    console.error("Service Worker registration failed:", error);
                });
        }
    </script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-messaging-compat.js"></script>
</body>

</html>